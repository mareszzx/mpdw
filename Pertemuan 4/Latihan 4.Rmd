---
title: "latihan mpdw 4"
author: "MARESKA RADELA PUTRA"
date: "2025-09-20"
output: rmdformats::readthedown
---

# White Noise

Proses pembangkitan suatu model deret waktu diawali dengan membangkitkan data white noise yang tidak memiliki autokorelasi dengan nilai harapan tertentu dan ragam yang konstan.

```{r}
set.seed(1016)
wn <- rnorm(300)
ts.plot(wn)
```

# MA(2)

Dalam kasus ini, akan dibangkitkan suatu data dengan model MA(2) sebanyak 300 data yang memiliki nilai $\theta_1 = 0.4$ dan $\theta_2 = 0.6$. Rumusan model tersebut adalah sebagai berikut

$$
y_t = e_t-0.4e_{t-1}-0.6e_{t-2}
$$

```{r}
set.seed(1016)
ma <- numeric(300) 
wn <- rnorm(300)

ma[1] <- wn[1]
ma[2] <- wn[2] - 0.4 * wn[1] 

```

```{r}
for(i in 3:300){
   ma[i] <- wn[i] - 0.4 * wn[i - 1] - 0.6 * wn[i - 2]
}
ma
```

Pembangkitan model MA(2) juga dapat dilakukan dengan menerapkan fungsi `arima.sim()`

```{r}
ma2 <- arima.sim(list(order=c(0,0,2), ma=c(0.4, 0.6)), n=300)
ma2
```

## Karakteristik MA(2)

## Plot Time Series

```{r}
par(mfrow = c(1, 2))
ts.plot(ma)
ts.plot(ma2)
```

Berdasarkan plot time series, terlihat bahwa baik hasil simulasi maupun dengan pembangkitan fungsi data MA(2) yang dibangkitkan stasioner dalam rataan

```{r}
par(mfrow = c(1, 1))
```


## Plot ACF

```{r}
par(mfrow = c(1, 2))
acf(ma)
acf(ma2)
```

Berdasarkan plot AFC tersebut baik hasil simulasi maupun dengan pembangkitan fungsi terlihat bahwa plot ACF *cuts off* di lag kedua

```{r}
par(mfrow = c(1, 1))
```

## Plot PACF

```{r}
par(mfrow = c(1, 2))
pacf(ma)
pacf(ma2)
```

Berdasarkan plot PACF tersebut baik hasil simulasi maupun dengan pembangkitan fungsi terlihat bahwa plot PACF cenderung *tails off* dan membentuk gelombang lembah karena nilai teta adalah positif

```{r}
par(mfrow = c(1, 1))
```


## Plot EACF

```{r}
TSA::eacf(ma)
```
```{r}
TSA::eacf(ma2)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ma <- ma[-1]
yt_ma

yt_1_ma <- ma[-300]
yt_1_ma
```

```{r}
plot(y=yt_ma,x=yt_1_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-1}$.

```{r}
cor(yt_ma,yt_1_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi jika dibulatkan akan mendekati perhitungan teoritis yaitu

$$
\rho_1=\frac{-\theta_1+\theta_1\theta_2}{1+\theta_1^2+\theta_2^2}=\frac{-0.4+0.4\times0.6}{1+0.4^2+0.6^2}=-0.105
$$

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ma2 <- ma[-c(1,2)]
yt_ma2

yt_2_ma <- ma[-c(299,300)]
yt_2_ma
```

```{r}
plot(y=yt_ma2,x=yt_2_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_ma2,yt_2_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi tergolong mendekati perhitungan teoritis yaitu

$$
\rho_2=\frac{-\theta_2}{1+\theta_1^2+\theta_2^2}=\frac{-0.6}{1+0.4^2+0.6^2}=-0.394
$$

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ma3 <- ma[-c(1,2,3)]
yt_ma3

yt_3_ma <- ma[-c(298, 299,300)]
yt_3_ma

```

```{r}
plot(y=yt_ma3,x=yt_3_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa $Y_t$ dan $Y_{t-3}$ sudah menunjukkan pola yang tidak beraturan atau bisa disebut tidak berpola.

```{r}
cor(yt_ma3,yt_3_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi mendekati nilai teoritis yang menyatakan bahwa $\rho_k=0$ untuk k>q

# AR(2)

Dalam kasus ini, akan dibangkitkan suatu data dengan model AR(2) sebanyak 300 data yang memiliki nilai $\phi_1 = 0.5$ dan $\phi_2 = 0.2$. Rumusan model tersebut adalah sebagai berikut

$$ Y_t = e_t+0.5Y_{t-1}+0.2Y_{t-2} $$

```{r}
set.seed(1016)
wn <- rnorm(300)

ar <- numeric(300)
ar[1] <- wn[1]
ar[2] <- wn[2] + 0.5 * ar[1]
```

```{r}
for (i in 3:300) {
  ar[i] <- wn[i] + 0.5 * ar[i-1] + 0.2 * ar[i-2]
}
ar
```

Pembangkitan model AR(2) juga dapat dilakukan dengan menerapkan fungsi `arima.sim()`

```{r}
ar2 <- arima.sim(list(order=c(2,0,0), ar=c(0.5,0.2)), n=300)
ar2
```

## Karakteristik AR(2)

## Plot Time Series

```{r}
par(mfrow = c(1, 2))
ts.plot(ar)
ts.plot(ar2)
```

Berdasarkan plot time series tersebut baik hasil simulasi maupun dengan pembangkitan fungsi terlihat bahwa data cenderung stasioner pada rataan

```{r}
par(mfrow = c(1, 1))
```


## Plot ACF

```{r}
par(mfrow = c(1, 2))
acf(ar)
acf(ar2)
```

Berdasarkan plot ACF tersebut baik hasil simulasi maupun dengan pembangkitan fungsi terlihat bahwa plot ACF cenderung *tails off*

```{r}
par(mfrow = c(1, 1))
```

## Plot PACF

```{r}
par(mfrow = c(1, 2))
pacf(ar)
pacf(ar2)
```

Berdasarkan plot PACF tersebut baik hasil simulasi maupun dengan pembangkitan fungsi terlihat bahwa plot PACF *cuts off* pada lag kedua

```{r}
par(mfrow = c(1, 1))
```

## Plot EACF

```{r}
TSA::eacf(ar)
```

```{r}
TSA::eacf(ar2)
```


Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(1) dan ordo MA(1)

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ar <- ar[-1]
yt_ar

yt_1_ar <- ar[-300]
yt_1_ar
```

```{r}
plot(y=yt_ar,x=yt_1_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$.

```{r}
cor(yt_ar,yt_1_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi cukup jauh dari perhitungan teoritis yaitu

$$
\rho_1=\frac{\phi_1}{1-\phi_2}=\frac{0.5}{1-0.2}=0.625
$$

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ar2 <- ar[-c(1,2)]
yt_ar2

yt_2_ar <- ar[-c(299,300)]
yt_2_ar
```

```{r}
plot(y=yt_ar2,x=yt_2_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_ar2,yt_2_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi cukup jauh dari perhitungan teoritis yaitu

$$
\rho_2=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}=\frac{\phi_2(1-\phi_2)+\phi_1^2}{1-\phi_2}=\frac{0.2(1-0.2)+0.5^2}{1-0.2}=0.5125
$$

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ar3 <- ar[-c(1,2,3)]
yt_ar3

yt_3_ar <- ar[-c(298,299,300)]
yt_3_ar
```

```{r}
plot(y=yt_ar3,x=yt_3_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_ar3,yt_3_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi cukup jauh dari perhitungan teoritis yaitu

$$
\rho_3=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}=\phi_1\rho_2+\phi_2\rho_1=0.5\times0.5125+0.2\times0.625=0.38125
$$


# ARMA(2,2)

Dalam kasus ini, akan dibangkitkan suatu data dengan model ARMA(2,2) sebanyak 300 data yang memiliki nilai $\theta_1 = 0.4$, $\theta_2 = 0.6$ serta $\phi_1 = 0.5$ dan $\phi_2 = 0.2$. Rumusan model tersebut adalah sebagai berikut

$$ Y_t = 0.5Y_{t-1}+0.2Y_{t-2}+e_t-0.4_{t-1}-0.6_{t-2} $$

```{r}
set.seed(1016)
theta1 = 0.4
theta2 = 0.6
phi1 = 0.5
phi2 = 0.2

y.arma=c(1:300)
for (i in 3:300){y.arma[i] = phi1*y.arma[i-1] + phi2*y.arma[i-2] +
                 wn[i] - theta1*wn[i-1] - theta2*wn[i-2]}
y.arma
```

Pembangkitan model ARMA(2,2) juga dapat dilakukan dengan menerapkan fungsi `arima.sim()`

```{r}
arma22 <- arima.sim(list(order=c(2,0,2), ar = c(0.5,0.2), ma = c(0.4,0.6)), n=300)
arma22
```

## Karakteristik ARMA(2,2)

## Plot Time Series

```{r}
par(mfrow = c(1, 2))
ts.plot(y.arma)
ts.plot(arma22)
```

Berdasarkan plot time series tersebut, terlihat bahwa model ARMA(2,2) cenderung stasioner dalam rataan

```{r}
par(mfrow = c(1, 1))
```


## Plot ACF

```{r}
par(mfrow = c(1, 2))
acf(y.arma)
acf(arma22)
```

Berdasarkan plot ACF tersebut, terlihat bahwa model ARMA(2,2) baik hasil simulasi maupun dengan pembangkitan fungsi memiliki plot ACF yang *tails off*

```{r}
par(mfrow = c(1, 1))
```

## Plot PACF

```{r}
par(mfrow = c(1, 2))
pacf(y.arma)
pacf(arma22)
```

Berdasarkan plot PACF tersebut, terlihat bahwa model ARMA(2,2) baik hasil simulasi maupun dengan pembangkitan fungsi memiliki plot PACF yang *tails off*

```{r}
par(mfrow = c(1, 1))
```

## Plot EACF

```{r}
TSA::eacf(y.arma)
```

```{r}
TSA::eacf(arma22)
```


Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(1) dan ordo MA(2)

## Scatterplot Antar Lag

### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_arma <- y.arma[-1]
yt_arma

yt_1_arma <- y.arma[-300]
yt_1_arma
```

```{r}
plot(y=yt_arma,x=yt_1_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$.

```{r}
cor(yt_arma,yt_1_arma)
```

### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_arma <- y.arma[-c(1,2)]
yt_arma

yt_2_arma <- y.arma[-c(299,300)]
yt_2_arma
```

```{r}
plot(y=yt_arma,x=yt_2_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_arma,yt_2_arma)
```

### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_arma <- y.arma[-c(1,2,3)]
yt_arma

yt_3_arma <- y.arma[-c(298,299,300)]
yt_3_arma
```

```{r}
plot(y=yt_arma,x=yt_3_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_arma,yt_3_arma)
```





